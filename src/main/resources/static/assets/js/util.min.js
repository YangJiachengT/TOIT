var winWidth=0;var winHeight=0;function findDimensions(){if(window.innerWidth){winWidth=window.innerWidth}else{if((document.body)&&(document.body.clientWidth)){winWidth=document.body.clientWidth}}if(window.innerHeight){winHeight=window.innerHeight}else{if((document.body)&&(document.body.clientHeight)){winHeight=document.body.clientHeight}}if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth){winHeight=document.documentElement.clientHeight;winWidth=document.documentElement.clientWidth}}function cmpPicker(){modalHref(ctx+"/cmp/picker","ajaxModal")}function isNullOrUndefined(a){if(a==null||a==""||a==undefined){return true}else{return false}}function modal(b,a){b.preventDefault();$remote=a.remote||a.href,$modal=$('<div class="modal" id="ajaxModal"><div class="modal-body"></div></div>');$("body").append($modal);$modal.modal({backdrop:"static",keyboard:false});$modal.load($remote)}function modalHref(b,a){$modal=$('<div class="modal" id="'+a+'"><div class="modal-body"></div></div>');$("body").append($modal);$modal.modal({backdrop:"static",keyboard:false});if(b==undefined){b=""}if(b.indexOf("?")>-1){b+="&"+(new Date()).valueOf()}else{b+="?"+(new Date()).valueOf()}$modal.load(b)}function closeModal(a){$("#"+a).modal("hide");$("#"+a).remove()}function cmpSelect(){modalHref(ctx+"/company/cmpSelector","ajaxModal")}function accountPicker(a){if(isNullOrUndefined(a)){a==1}modalHref(ctx+"/system/account/accountPicker?type="+a,"ajaxModal")}function uploadWords(b,c,a){b.preventDefault();$remote=ctx+"/attach/upload/words?attachField="+c+"&attachDivId="+a,$modal=$('<div class="modal" id="filesModal"><div class="modal-body"></div></div>');$("body").append($modal);$modal.modal({backdrop:"static",keyboard:false});$modal.load($remote)}function uploadOneFileComplete(d,c,b,f,e){$("#contractAttach").val(b);$("#contractAttach").trigger("input:changed",b);var g=ctx+"/attach/download?attachId="+d;var a=f;if(typeof(readonly)=="undefined"){readonly=false}var h='  <div style="padding:15px;float:left;">	<div>';if(!isImageType(e)){h+="	<img src="+ctx+'"/assets/images/upload.png"  style="height:150px;" />'}else{h+='	<img src="'+g+'" data-high-res-src="'+g+'" class="gallery-items"  style="height:150px"  />'}h+='	</div>	<div style="margin-top:5px;">'+a+'</div>	<div class="text-left" style="height:25px">	  <a class="btn btn-white btn-bitbucket btn-xs" href="'+g+'" target="_blank">		<i class="fa fa-download"></i> 下载	  </a>';if(!readonly){h+='	  <a class="btn btn-white btn-bitbucket btn-xs" onclick="_removeAttach(\''+b+"','"+a+"','"+d+'\')">		<i class="fa fa-trash"></i> 删除	  </a>'}h+="	</div>  </div>";$("#"+c).html('<div class="file-box" name="'+d+'" id="attachDiv_'+b+'">'+h+"</div>");if($("#attachError")){$("#attachError").remove();if($("#btnSubmit")){$("#attachError").removeAttr("disabled")}}}function uploadImage(a,c,b){a.preventDefault();$remote=ctx+"/attach/upload/image?attachField="+c+"&attachImage="+b,$modal=$('<div class="modal" id="filesModal"><div class="modal-body"></div></div>');$("body").append($modal);$modal.modal({backdrop:"static",keyboard:false});$modal.load($remote)}function uploadSingleComplete(g,f,b,a,c,h){$("#"+g).val(b);var d=ctx+a;var e='  <div style="padding:0 0 0 1.0715rem;width:150px;height:150px;" >	<figure class="overlay overlay-hover" style="height:135px;width:135px;">';if(!isImageType(c)){e+=' <div class="img_wd">'+h+"</div>"}else{e+=' <img class="overlay-figure gallery-items" src="'+d+'"data-high-res-src="'+d+'" alt="'+h+'" width="100%" height="100%">'}e+='	<figcaption class="overlay-panel overlay-background overlay-fade overlay-icon">		<a class="icon wb-search" style="margin:0 5px;font-size:1.286rem;width:1.286rem"  href="javascript:void(0)" onclick="clickImg(event,this)"></a>		<a class="icon wb-download" style="margin:0 5px;font-size:1.286rem;width:1.286rem" href="'+d+'" target="_self" ></a>		<a class="icon wb-close" style="margin:0 5px;font-size:1.286rem;width:1.286rem"  onclick="_removeSingleAttach(\''+b+"','"+f+"','"+g+'\')"></a>		<h5 class="animation-slide-bottom" style="margin:0">'+h+"</h5>	</figcaption>  </figure></div>";$("#"+f).html(e);if(typeof uploadSuccess==="function"){uploadSuccess(b,f)}else{}}function _removeSingleAttach(b,c,a){alertify.confirm("确认删除该附件吗？",function(){$.ajax({type:"post",url:ctx+"/attach/maintain/remove",data:{attachId:b},dataType:"json",success:function(d){if(d.state=="ok"){$("#"+a).val("");var e='  <div style="padding:0 0 0 1.0715rem;width:150px;height:150px;" >	<figure class="overlay" style="height:135px;width:135px;">	<img src='+ctx+'"/assets/images/upload.png"  class="overlay-figure" />	<figcaption class="overlay-panel overlay-background overlay-fade overlay-icon">		<a class="icon wb-upload" style="margin:0 5px;font-size:1.286rem;width:1.286rem" onclick="uploadImage(event,\''+a+"','"+c+"')\"></a> 	</figcaption>  </figure></div>";$("#"+c).html(e);if(typeof removeSingleSuccess==="function"){removeSingleSuccess(b,c)}else{console.log("不存在该函数")}}else{console.log(d)}}})},function(){})}function uploadFiles(b,c,a){b.preventDefault();$remote=ctx+"/attach/upload/files?attachField="+c+"&attachDivId="+a,$modal=$('<div class="modal" id="filesModal"><div class="modal-body"></div></div>');$("body").append($modal);$modal.modal({backdrop:"static",keyboard:false});$modal.load($remote)}function isImageType(a){if(isNullOrUndefined(a)){return false}var b=a.toLowerCase();if("jpg"==b||"jpeg"==b||"tiff"==b||"raw"==b||"bmp"==b||"gif"==b||"png"==b){return true}return false}function uploadFileComplete(e,d,c,g,f,b){var a=$("#"+e).val();if(a){a+=","+c}else{a=c}$("#"+e).val(a);$("#"+attachField).trigger("input:changed",a);dispAnAttachsFile(e,d,c,g,f,b)}function dispAnAttachsFile(i,d,a,h,k,g){var f=ctx+"/attach/download?attachId="+a;var l=ctx+"/attach/download/thumb?attachId="+a;var e=(typeof uploadPsnlAttachSuccess==="function");var j=h;var c="150px";if(e){c="190px"}if(typeof(g)=="undefined"){g=false}var b='  <div style="padding:0 0 0.9rem 1.0715rem;width:150px;height:'+c+';" id="attachDiv_'+a+'">	<figure class="overlay overlay-hover" style="height:135px;width:135px;">';if(!isImageType(k)){b+='<div class="img_wd">'+h+"</div>"}else{b+=' <img class="overlay-figure gallery-items" src="'+l+'"data-high-res-src="'+f+'" alt="'+h+'" >'}b+='	<figcaption class="overlay-panel overlay-background overlay-fade overlay-icon">		<a class="icon wb-search" style="margin:0 5px;font-size:1.286rem;width:1.286rem"  href="javascript:void(0)" onclick="clickImg(event,this)"></a>		<a class="icon wb-download" style="margin:0 5px;font-size:1.286rem;width:1.286rem" href="'+f+'" target="_self" ></a>		<a class="icon wb-close" style="margin:0 5px;font-size:1.286rem;width:1.286rem"  onclick="_removeAttach(\''+a+"','"+j+"','"+i+"')\"></a>";if(!e){b+='		<h5 class="animation-slide-bottom" style="margin:0">'+h+"</h5>"}b+="	</figcaption>  </figure>";if(e){b+='		<h5 class="animation-slide-bottom" style="margin:10px;text-align:center;word-wrap:break-word;display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp:2;overflow: hidden;">'+h+"</h5>"}b+="</div>";$("#"+d).prepend(b);if(typeof uploadPsnlAttachSuccess==="function"){uploadPsnlAttachSuccess(a)}else{if(typeof uploadSuccess==="function"){uploadSuccess(a)}else{console.log("不存在该函数")}}}function _removeAttach(b,c,a){alertify.confirm("确认删除该附件吗？",function(){$.ajax({type:"post",url:ctx+"/attach/maintain/remove",data:{attachId:b},dataType:"json",success:function(d){if(d.state=="ok"){$("#attachDiv_"+b).remove();var h=$("#"+a).val();h=h.replace(b,"");var g="";var e=h.split(",");for(var f=0;f<e.length;f++){if(!isNullOrUndefined(e[f])){if(!isNullOrUndefined(g)){g+=","}g+=e[f]}}$("#"+a).val(g);if(typeof removePsnlAttachSuccess==="function"){removePsnlAttachSuccess(b)}}else{console.log(d)}}})},function(){})}function clickImg(b,a){imgShow();$(a).parent().siblings().click()}function registerAlertify4Local(){alertify.okBtn("确定").cancelBtn("取消").theme("bootstrap").logPosition("top right").delay(2500)}function str2Date(h){if(isNullOrUndefined(h)||h.length<8){return null}var c=h.substring(0,4);var e=h.substring(4,6);var a=h.substring(6,8);var b=0,g=0;if(h.length>8){b=h.substring(9,11);g=h.substring(12,14)}var f=new Date();f.setFullYear(c,e-1,a);f.setHours(b);f.setMinutes(g);f.setSeconds(0);return f}function month2Str(c){if(isNullOrUndefined(c)){return""}var d=c.getFullYear();var a=c.getMonth()+1;if(a<10){a="0"+a}var b=d+""+a;return b}function plusMonth(a,c){var b=str2Date(a+"01");b.setMonth(b.getMonth()+c);return month2Str(b)}function imgShow(){var a=ImageViewer();$(".gallery-items").click(function(){var c=$(this).attr("src"),b=$(this).attr("data-high-res-src");a.show(c,b)})}function resultErr(a){if(a.result==1){toastr.error("用户未登录或超时，请重新登录！","用户未登录或超时",{positionClass:"toast-top-center"});if(window!=top){top.location.href=ctx+"/login"}else{location.href="/"}}else{toastr.error(a.msg,"",{positionClass:"toast-top-center"})}}function leftHeight(a){setTimeout(function(){var b=$(".panel-body").outerHeight(true);if(winHeight>b){$(".scrollable-container").css({height:(winHeight-150)+"px"})}else{$(".scrollable-container").css({height:(b)+"px"})}},a)}function isNumber(c){if(c==null||c==""){return true}c=c+"";if(c.charAt(0)=="."){return false}var a="^[0-9.]+$";var b=new RegExp(a);if(c.search(b)!=-1){return true}else{return false}return true}function checkNumber(a){if(a!=null&&!isNumber(a.value)){a.value="0"}};